<% # provide(:page_title, "Register money transfer") %>
<% project_members = @members.map {|m| [m.id, m.name, m.pattern]}.unshift([0, "Choose Member", ""]) %>

<%= react_component 'Form', 
authenticity_token: form_authenticity_token, 
title: "Register money transfer",
action: transfers_path,
members: project_members,
fields: [
  {
    fieldType: "p",
    text: "Add multiple transfers from Excel file."
  },
  {
    fieldType: "file",
    attribute: "excelFile",
    attributeName: "Upload Excel file...",
    defaultValue: ""
  },
  {
    fieldType: "p",
    text: "Add single transfer manually."
  },
  {
    fieldType: "text",
    attribute: "transfers[0][message]",
    attributeName: "Message",
    defaultValue: "",
    handleBlur: "guessMember"
  },
  {
    fieldType: "number",
    attribute: "transfers[0][amount]",
    attributeName: "Amount",
    defaultValue: ""
  },
  {
    fieldType: "date",
    attribute: "transfers[0][transferred_at]",
    attributeName: "Transfer date",
    defaultValue: Date.current.to_date
  },
  {
    fieldType: "select",
    attribute: "transfers[0][member_id]",
    attributeName: "Which member made the transfer",
    options: @members.map {|m| [m.id, m.name]}.unshift([0, "Choose Member"]),
    isControlling: "project_id", # Get member's projects when member is selected
    controlType: "select",
    controlUrl: "/members/:id/projects.json"
  },
  {
    fieldType: "select",
    attribute: "project_id",
    attributeName: "Select a project to add the transfer to",
    options: [],
  },
  {
    fieldType: "submit",
    attributeName: "Add transfer"
  }
] %>
